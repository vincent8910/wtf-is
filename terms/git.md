# Git — 後悔藥 / 時光機

> **白話說：** Git 就像電動遊戲裡的「存檔功能」。你可以隨時存檔，搞砸了就讀取上一個存檔，回到還沒搞砸之前的狀態。

---

## 它到底是什麼？

Git 是一個**版本控制系統**——聽起來很厲害，但其實做的事情很簡單：**幫你記住每一次的修改**。

想像你在寫一份報告：
- 報告\_v1.docx
- 報告\_v2\_修改版.docx
- 報告\_v3\_最終版.docx
- 報告\_v3\_最終版\_真的最終版.docx
- 報告\_v3\_最終版\_老闆改完.docx

這就是「手動版本控制」——亂七八糟又佔空間。

Git 幫你自動管理這些版本，而且：
- 每個版本只記錄「改了什麼」，不會複製整個檔案
- 你可以隨時跳回任何一個歷史版本
- 多人同時改同一個檔案也不會互相覆蓋

> 💡 **Git vs [GitHub](github.md)：** Git 是裝在你電腦上的工具（單機版），GitHub 是雲端平台（多人協作用）。詳細差異請看 [GitHub 說明頁](github.md)。

## 為什麼我需要它？

當你讓 Claude Code 修改你的檔案時，萬一它改錯了（AI 偶爾也會出槌），Git 就是你的**後悔藥**：

```bash
git checkout -- .    # 回復所有檔案到上次存檔的狀態
```

一行指令，時光倒流。沒有 Git，你只能哭。

如果你是 PM 需要寫技術規格（Tech Spec），Git 更是必學——因為技術文件通常放在 [GitHub](github.md) 上跟程式碼一起管理，懂 Git 才能參與這個流程。

---

## 完整工作流程：一個任務從頭到尾

以下用「PM 修改一份技術規格文件」當範例，帶你走一遍完整流程。

### 第一步：看看現在的狀態

```bash
git status
```

這會告訴你：哪些檔案被修改了、哪些是新增的、哪些已經準備好要存檔。

就像出門前檢查背包——確認你帶了什麼、忘了什麼。

### 第二步：看看改了什麼（可選但推薦）

```bash
git diff
```

這會顯示每個檔案「改了哪幾行」，用紅色（刪除）和綠色（新增）標記。

就像把新舊版本的文件拿來逐行比對。在存檔之前先檢查一下，確保沒有不小心改錯的地方。

### 第三步：把修改「放進購物車」

```bash
git add tech-spec.md        # 只加特定檔案
git add .                   # 或者全部加進去
```

`git add` 不是存檔，只是「準備好要存檔的東西」。就像你在超市把東西放進購物車，但還沒結帳。

> 💡 **建議加特定檔案**，而不是 `git add .` 全加。這樣可以避免把不相關的檔案（像暫存檔、個人筆記）也一起存進去。

### 第四步：正式存檔（commit）

```bash
git commit -m "更新 API 規格：新增使用者驗證流程"
```

這就是**按下存檔鍵**的瞬間。`-m` 後面的文字是「存檔備註」，用來記錄你這次改了什麼。

好的存檔備註長這樣：

| ✅ 好的 commit message | ❌ 不好的 |
|------------------------|----------|
| 「新增使用者登入 API 規格」 | 「更新」 |
| 「修正付款流程的錯誤描述」 | 「改東西」 |
| 「移除過期的測試帳號資訊」 | 「fix」 |

原則：**讓三個月後的你（或同事）看到這段備註，能馬上知道當時改了什麼。**

### 第五步：上傳到雲端（push）

```bash
git push
```

到目前為止，你的存檔都只在你自己的電腦上。`git push` 把它**上傳到 [GitHub](github.md)**，讓其他人也能看到你的修改。

就像你寫好文件後，按下「上傳到共用雲端資料夾」。

> ⚠️ **注意：** push 之後別人就看得到了，所以確保你 commit 的內容是正確的再 push。

---

## 多人協作：當你跟別人改到同一個地方

這是 Git 最重要也最容易讓人頭痛的部分。

### 情境：你跟工程師同時修改了同一份文件

```
你（PM）：     修改了 tech-spec.md 的第 15 行
工程師小明：    也修改了 tech-spec.md 的第 15 行
```

你們各自改各自的，但最後上傳時就「撞車」了——Git 不知道該用誰的版本。

### 解法：先拉最新版本再上傳（rebase）

```bash
# 你已經 commit 了你的修改，準備 push 時發現推不上去
git push
# ❌ 被拒絕！因為遠端有你還沒拿到的新修改

# 第一步：把遠端最新的修改拉下來，並把你的修改「接」在後面
git pull --rebase

# 如果沒有衝突 → 自動完成！直接 push
git push
```

> 💡 **`git pull --rebase` 是什麼意思？**
>
> 想像排隊結帳：
> - `git pull`（普通版）：你先出去買東西，回來時插回原本的位置 → 歷史紀錄會變得交叉混亂
> - `git pull --rebase`：你先讓別人結帳完，然後你排到最後面 → 歷史紀錄一條直線，乾淨好讀

### 如果真的衝突了（兩個人改了同一行）

```bash
git pull --rebase
# ⚠️ Git 說：CONFLICT！你們改了同一個地方，我不知道該用哪個版本
```

打開有衝突的檔案，你會看到這種標記：

```
<<<<<<< HEAD（你的版本）
使用者驗證需要在 3 秒內完成
=======
使用者驗證需要在 5 秒內完成
>>>>>>> abc1234（別人的版本）
```

**你要做的就是：跟對方討論，決定要用哪個版本（或合併兩個），然後手動修改成正確的內容：**

```
使用者驗證需要在 5 秒內完成（與工程師確認後調整）
```

把 `<<<<<<<`、`=======`、`>>>>>>>` 這些標記全部刪掉，只留下最終的正確內容。然後：

```bash
git add tech-spec.md          # 告訴 Git「我解決好了」
git rebase --continue         # 繼續完成 rebase
git push                      # 上傳
```

> 💡 **衝突不可怕！** 它只是 Git 在說「我不敢幫你決定」。你花 2 分鐘手動挑一個正確版本就解決了。

---

## 分支（Branch）：不怕搞砸的實驗場

分支就像**平行宇宙**——你可以開一個新分支去嘗試修改，不會影響到主版本。

```bash
# 建立新分支並切換過去
git checkout -b feature/update-api-spec

# 在這個分支上隨便改、隨便實驗
# ... 修改檔案 ...
git add .
git commit -m "實驗新的 API 格式"

# 改完覺得 OK，切回主分支
git checkout main

# 把實驗分支的修改合併進來
git merge feature/update-api-spec
```

用生活來比喻：
- **main**（主分支）＝ 正式版的文件，大家都在看的
- **feature/xxx**（功能分支）＝ 你的草稿紙，改到滿意再正式發表

> 💡 **為什麼要用分支？** 因為直接在 main 上改，萬一改壞了所有人都受影響。在分支上改，就算搞砸也只是丟掉那個分支，主版本毫髮無傷。

---

## 指令速查表

### 日常操作（每天都會用到）

| 指令 | 做什麼 | 比喻 |
|------|--------|------|
| `git status` | 看現在的狀態 | 檢查背包裡有什麼 |
| `git diff` | 看改動細節 | 新舊版本比對 |
| `git add 檔案名稱` | 準備要存檔的內容 | 放進購物車 |
| `git commit -m "說明"` | 正式存檔 | 按下存檔鍵 |
| `git push` | 上傳到 GitHub | 上傳到雲端共享 |
| `git pull --rebase` | 拉取別人的最新修改 | 更新到最新版本 |

### 分支操作

| 指令 | 做什麼 | 比喻 |
|------|--------|------|
| `git branch` | 看有哪些分支 | 看有哪些平行宇宙 |
| `git checkout -b 名稱` | 建立新分支並切過去 | 開一個平行宇宙 |
| `git checkout main` | 切回主分支 | 回到正式版 |
| `git merge 分支名稱` | 把分支合併回來 | 把草稿變成正式版 |

### 後悔藥（救命用）

| 指令 | 做什麼 | 比喻 |
|------|--------|------|
| `git checkout -- 檔案` | 回復單個檔案 | 只還原一個東西 |
| `git checkout -- .` | 回復所有檔案 | 全部打回原形 |
| `git log --oneline` | 看存檔歷史 | 翻看所有存檔記錄 |
| `git stash` | 暫時收起修改 | 把桌上的東西先收進抽屜 |
| `git stash pop` | 把暫存的修改拿回來 | 從抽屜拿回來繼續做 |

---

## 安裝

👉 **[Git 官方網站](https://git-scm.com/)**

- **macOS**：可能已經內建。在 Terminal 輸入 `git --version`，如果有版本號就不用裝
- **Windows**：下載安裝時會附帶 [Git Bash](git-bash.md)（一個好用的 Terminal 替代品）

---

**[← 回到術語總覽](../README.md)** · **[Git vs GitHub 差在哪？→](github.md)** · **[Windows 用戶？認識 Git Bash →](git-bash.md)**
